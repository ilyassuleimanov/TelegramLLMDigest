[2025-05-18T19:03:07.120+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: telegram_summary_channel_1137503644.parse_channel_posts scheduled__2025-05-18T18:30:00+00:00 [queued]>
[2025-05-18T19:03:07.129+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: telegram_summary_channel_1137503644.parse_channel_posts scheduled__2025-05-18T18:30:00+00:00 [queued]>
[2025-05-18T19:03:07.130+0000] {taskinstance.py:2170} INFO - Starting attempt 2 of 2
[2025-05-18T19:03:07.159+0000] {taskinstance.py:2191} INFO - Executing <Task(DockerOperator): parse_channel_posts> on 2025-05-18 18:30:00+00:00
[2025-05-18T19:03:07.165+0000] {standard_task_runner.py:60} INFO - Started process 639 to run task
[2025-05-18T19:03:07.169+0000] {standard_task_runner.py:87} INFO - Running: ['airflow', 'tasks', 'run', 'telegram_summary_channel_1137503644', 'parse_channel_posts', 'scheduled__2025-05-18T18:30:00+00:00', '--job-id', '44', '--raw', '--subdir', 'DAGS_FOLDER/dag_generator.py', '--cfg-path', '/tmp/tmp3xpzxt78']
[2025-05-18T19:03:07.172+0000] {standard_task_runner.py:88} INFO - Job 44: Subtask parse_channel_posts
[2025-05-18T19:03:07.242+0000] {task_command.py:423} INFO - Running <TaskInstance: telegram_summary_channel_1137503644.parse_channel_posts scheduled__2025-05-18T18:30:00+00:00 [running]> on host aef6e8046217
[2025-05-18T19:03:07.323+0000] {taskinstance.py:2480} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='airflow' AIRFLOW_CTX_DAG_ID='telegram_summary_channel_1137503644' AIRFLOW_CTX_TASK_ID='parse_channel_posts' AIRFLOW_CTX_EXECUTION_DATE='2025-05-18T18:30:00+00:00' AIRFLOW_CTX_TRY_NUMBER='2' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-05-18T18:30:00+00:00'
[2025-05-18T19:03:07.395+0000] {docker.py:359} INFO - Starting docker container from image telegram_parser_task:latest
[2025-05-18T19:03:08.145+0000] {docker.py:429} INFO - [2025-05-18 19:03:08] [INFO] [Parser] - –ó–∞–ø—É—Å–∫ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –ø–∞—Ä—Å–µ—Ä–∞ (–ª–æ–∫–∞–ª—å–Ω—ã–π –∏–ª–∏ –ø—Ä—è–º–æ–π –≤—ã–∑–æ–≤)...
[2025-05-18T19:03:08.146+0000] {docker.py:429} INFO - [2025-05-18 19:03:08] [INFO] [Parser] - --- –ó–∞–ø—É—Å–∫ —Å–∫—Ä–∏–ø—Ç–∞ –ø–∞—Ä—Å–µ—Ä–∞ (Airflow Task) ---
[2025-05-18 19:03:08] [INFO] [Parser] - –¶–µ–ª–µ–≤–æ–π –∫–∞–Ω–∞–ª (–∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –¥–ª—è Telethon): https://t.me/trader_chernyh
[2025-05-18 19:03:08] [INFO] [Parser] - –ß–∏—Å–ª–æ–≤–æ–π ID –∫–∞–Ω–∞–ª–∞ (–∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞ DAG): 1137503644
[2025-05-18 19:03:08] [INFO] [Parser] - –¶–µ–ª–µ–≤–∞—è –¥–∞—Ç–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞: 2025-05-18
[2025-05-18 19:03:08] [INFO] [Parser] - –ü–æ–ø—ã—Ç–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î (1/5): host=postgres_results_db_service port=5432 dbname=parsing_results user=parser_user
[2025-05-18T19:03:08.158+0000] {docker.py:429} INFO - [2025-05-18 19:03:08] [INFO] [Parser] - –£—Å–ø–µ—à–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î!
[2025-05-18 19:03:08] [INFO] [Parser] - –ü—Ä–æ–≤–µ—Ä–∫–∞/—Å–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã 'telegram_messages'...
[2025-05-18T19:03:08.165+0000] {docker.py:429} INFO - [2025-05-18 19:03:08] [INFO] [Parser] - –°—Ö–µ–º–∞ –ë–î 'telegram_messages' –ø—Ä–æ–≤–µ—Ä–µ–Ω–∞/–æ–±–Ω–æ–≤–ª–µ–Ω–∞.
[2025-05-18 19:03:08] [INFO] [Parser] - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram –∫–ª–∏–µ–Ω—Ç–∞ —Å —Å–µ—Å—Å–∏–µ–π: /app/session/my_telegram_session
[2025-05-18T19:03:08.165+0000] {docker.py:429} INFO - [2025-05-18 19:03:08] [INFO] [Parser] - –§–∞–π–ª —Å–µ—Å—Å–∏–∏ '/app/session/my_telegram_session.session' —Å—É—â–µ—Å—Ç–≤—É–µ—Ç: True
[2025-05-18T19:03:08.166+0000] {docker.py:429} INFO - [2025-05-18 19:03:08] [INFO] [Parser] - –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Telegram...
[2025-05-18T19:03:08.167+0000] {docker.py:429} INFO - [2025-05-18 19:03:08] [INFO] [Parser] - Connecting to 149.154.167.51:443/TcpFull...
[2025-05-18T19:03:08.483+0000] {docker.py:429} INFO - [2025-05-18 19:03:08] [INFO] [Parser] - Connection to 149.154.167.51:443/TcpFull complete!
[2025-05-18T19:03:10.501+0000] {docker.py:429} INFO - [2025-05-18 19:03:10] [INFO] [Parser] - –£—Å–ø–µ—à–Ω–æ –ø–æ–¥–∫–ª—é—á–µ–Ω –∫ Telegram –∫–∞–∫ –ò–ª—å—è—Å (ID: 1257870016).
[2025-05-18 19:03:10] [INFO] [Parser] - –ù–∞—á–∞–ª–æ –ø–∞—Ä—Å–∏–Ω–≥–∞ –∫–∞–Ω–∞–ª–∞ 'https://t.me/trader_chernyh' –∑–∞ –¥–∞—Ç—É 2025-05-18
[2025-05-18T19:03:10.502+0000] {docker.py:429} INFO - [2025-05-18 19:03:10] [INFO] [Parser] - –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∫–∞–Ω–∞–ª–µ 'https://t.me/trader_chernyh'...
[2025-05-18T19:03:10.844+0000] {docker.py:429} INFO - [2025-05-18 19:03:10] [INFO] [Parser] - –ö–∞–Ω–∞–ª –Ω–∞–π–¥–µ–Ω: '–ï–≤–≥–µ–Ω–∏–π –ß–µ—Ä–Ω—ã—Ö –∏ 401üçã' (ID: 1137503644)
[2025-05-18 19:03:10] [INFO] [Parser] - –ò—Ç–µ—Ä–∞—Ü–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π —Å offset_date=2025-05-19T00:00:00+00:00 (–ø–æ–∏—Å–∫ —Å–æ–æ–±—â–µ–Ω–∏–π –î–û —ç—Ç–æ–π –¥–∞—Ç—ã)...
[2025-05-18T19:03:11.940+0000] {docker.py:429} INFO - [2025-05-18 19:03:11] [INFO] [Parser] - –î–æ—Å—Ç–∏–≥–Ω—É—Ç–æ –Ω–∞—á–∞–ª–æ –¥–Ω—è 2025-05-18 (—Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç 2025-05-17 17:37:04+00:00). –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∏—Ç–µ—Ä–∞—Ü–∏–∏.
[2025-05-18 19:03:11] [INFO] [Parser] - –ü–∞—Ä—Å–∏–Ω–≥ –∑–∞ 2025-05-18 –∑–∞–≤–µ—Ä—à–µ–Ω. –ü–æ–ª—É—á–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–π: 2
[2025-05-18 19:03:11] [INFO] [Parser] - –°–ø–∏—Å–æ–∫ —Å–æ–æ–±—â–µ–Ω–∏–π —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç (–æ—Ç —Å—Ç–∞—Ä—ã—Ö –∫ –Ω–æ–≤—ã–º).
[2025-05-18 19:03:11] [INFO] [Parser] - –£—Å–ø–µ—à–Ω–æ –ø–æ–ª—É—á–µ–Ω–æ 2 —Å–æ–æ–±—â–µ–Ω–∏–π –∏–∑ Telegram.
[2025-05-18 19:03:11] [INFO] [Parser] - –ù–∞—á–∞–ª–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è 2 —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –ë–î...
[2025-05-18T19:03:11.940+0000] {docker.py:429} INFO - [2025-05-18 19:03:11] [WARNING] [Parser] - –ù–µ —É–¥–∞–ª–æ—Å—å –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å bytes –∫–∞–∫ UTF-8, –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ base64 –∏–ª–∏ –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä.
[2025-05-18T19:03:11.941+0000] {docker.py:429} INFO - [2025-05-18 19:03:11] [WARNING] [Parser] - –ù–µ —É–¥–∞–ª–æ—Å—å –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å bytes –∫–∞–∫ UTF-8, –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ base64 –∏–ª–∏ –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä.
[2025-05-18T19:03:11.942+0000] {docker.py:429} INFO - [2025-05-18 19:03:11] [WARNING] [Parser] - –ù–µ —É–¥–∞–ª–æ—Å—å –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å bytes –∫–∞–∫ UTF-8, –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ base64 –∏–ª–∏ –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä.
[2025-05-18 19:03:11] [WARNING] [Parser] - –ù–µ —É–¥–∞–ª–æ—Å—å –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å bytes –∫–∞–∫ UTF-8, –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ base64 –∏–ª–∏ –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä.
[2025-05-18 19:03:11] [WARNING] [Parser] - –ù–µ —É–¥–∞–ª–æ—Å—å –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å bytes –∫–∞–∫ UTF-8, –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ base64 –∏–ª–∏ –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä.
[2025-05-18 19:03:11] [WARNING] [Parser] - –ù–µ —É–¥–∞–ª–æ—Å—å –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å bytes –∫–∞–∫ UTF-8, –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ base64 –∏–ª–∏ –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä.
[2025-05-18 19:03:11] [WARNING] [Parser] - –ù–µ —É–¥–∞–ª–æ—Å—å –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å bytes –∫–∞–∫ UTF-8, –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ base64 –∏–ª–∏ –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä.
[2025-05-18T19:03:11.943+0000] {docker.py:429} INFO - [2025-05-18 19:03:11] [WARNING] [Parser] - –ù–µ —É–¥–∞–ª–æ—Å—å –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å bytes –∫–∞–∫ UTF-8, –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ base64 –∏–ª–∏ –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä.
[2025-05-18 19:03:11] [WARNING] [Parser] - –ù–µ —É–¥–∞–ª–æ—Å—å –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å bytes –∫–∞–∫ UTF-8, –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ base64 –∏–ª–∏ –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä.
[2025-05-18 19:03:11] [WARNING] [Parser] - –ù–µ —É–¥–∞–ª–æ—Å—å –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å bytes –∫–∞–∫ UTF-8, –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ base64 –∏–ª–∏ –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä.
[2025-05-18T19:03:11.947+0000] {docker.py:429} INFO - [2025-05-18 19:03:11] [INFO] [Parser] - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î –∑–∞–≤–µ—Ä—à–µ–Ω–æ. –ù–æ–≤—ã—Ö –∑–∞–ø–∏—Å–µ–π: 0, –ø—Ä–æ–ø—É—â–µ–Ω–æ (–æ—à–∏–±–∫–∏/–¥—É–±–ª–∏–∫–∞—Ç—ã): 2.
[2025-05-18 19:03:11] [INFO] [Parser] - –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ –ë–î: 0 –Ω–æ–≤—ã—Ö, 2 –ø—Ä–æ–ø—É—â–µ–Ω–æ.
[2025-05-18 19:03:11] [ERROR] [Parser] - –ù–∏ –æ–¥–Ω–æ –∏–∑ –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –Ω–µ –±—ã–ª–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ –≤ –ë–î –∏–∑-–∑–∞ –æ—à–∏–±–æ–∫.
[2025-05-18T19:03:11.947+0000] {docker.py:429} INFO - [2025-05-18 19:03:11] [ERROR] [Parser] - –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –≤ main: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞: –Ω–µ —É–¥–∞–ª–æ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –ë–î.
Traceback (most recent call last):
  File "/app/telegram_parser.py", line 505, in main
    raise Exception("–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞: –Ω–µ —É–¥–∞–ª–æ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –ë–î.")
Exception: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞: –Ω–µ —É–¥–∞–ª–æ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –ë–î.
[2025-05-18T19:03:11.947+0000] {docker.py:429} INFO - [2025-05-18 19:03:11] [INFO] [Parser] - –ó–∞–ø–∏—Å—å –¥–∞–Ω–Ω—ã—Ö XCom –≤ —Ñ–∞–π–ª: /airflow/xcom/return.json
[2025-05-18T19:03:11.949+0000] {docker.py:429} INFO - [2025-05-18 19:03:11] [INFO] [Parser] - –°–æ–∑–¥–∞–Ω–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –¥–ª—è XCom: /airflow/xcom
[2025-05-18T19:03:11.949+0000] {docker.py:429} INFO - [2025-05-18 19:03:11] [INFO] [Parser] - –î–∞–Ω–Ω—ã–µ XCom —É—Å–ø–µ—à–Ω–æ –∑–∞–ø–∏—Å–∞–Ω—ã: {'channel_id': 1137503644, 'target_date_str': '2025-05-18', 'status': 'failure', 'error_type': 'Exception', 'error_message': '–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞: –Ω–µ —É–¥–∞–ª–æ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –ë–î.'}
[2025-05-18 19:03:11] [INFO] [Parser] - –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –æ—Ç Telegram...
[2025-05-18T19:03:11.950+0000] {docker.py:429} INFO - [2025-05-18 19:03:11] [INFO] [Parser] - Disconnecting from 149.154.167.51:443/TcpFull...
[2025-05-18T19:03:11.950+0000] {docker.py:429} INFO - [2025-05-18 19:03:11] [INFO] [Parser] - Disconnection from 149.154.167.51:443/TcpFull complete!
[2025-05-18T19:03:11.970+0000] {docker.py:429} INFO - [2025-05-18 19:03:11] [INFO] [Parser] - –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å Telegram –∑–∞–∫—Ä—ã—Ç–æ.
[2025-05-18 19:03:11] [INFO] [Parser] - –ó–∞–∫—Ä—ã—Ç–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å –ë–î...
[2025-05-18T19:03:11.972+0000] {docker.py:429} INFO - [2025-05-18 19:03:11] [INFO] [Parser] - –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å –ë–î –∑–∞–∫—Ä—ã—Ç–æ.
[2025-05-18 19:03:11] [INFO] [Parser] - --- –°–∫—Ä–∏–ø—Ç –ø–∞—Ä—Å–µ—Ä–∞ –∑–∞–≤–µ—Ä—à–µ–Ω —Å –∫–æ–¥–æ–º –≤—ã—Ö–æ–¥–∞: 1 ---
[2025-05-18T19:03:11.972+0000] {docker.py:429} INFO - [2025-05-18 19:03:11] [INFO] [Parser] - –ü–µ—Ä–µ—Ö–≤–∞—á–µ–Ω SystemExit —Å –∫–æ–¥–æ–º 1. –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ.
[2025-05-18 19:03:11] [INFO] [Parser] - –°–∫—Ä–∏–ø—Ç –ø–∞—Ä—Å–µ—Ä–∞ –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–æ –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è —Å –∫–æ–¥–æ–º 1 (–∏–∑ __main__ –±–ª–æ–∫–∞).
[2025-05-18T19:03:12.300+0000] {taskinstance.py:2698} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 433, in _execute_task
    result = execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/providers/docker/operators/docker.py", line 502, in execute
    return self._run_image()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/providers/docker/operators/docker.py", line 376, in _run_image
    return self._run_image_with_mounts(self.mounts, add_tmp_variable=False)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/providers/docker/operators/docker.py", line 437, in _run_image_with_mounts
    raise DockerContainerFailedException(f"Docker container failed: {result!r}", logs=log_lines)
airflow.providers.docker.exceptions.DockerContainerFailedException: Docker container failed: {'StatusCode': 1}
[2025-05-18T19:03:12.304+0000] {taskinstance.py:1138} INFO - Marking task as FAILED. dag_id=telegram_summary_channel_1137503644, task_id=parse_channel_posts, execution_date=20250518T183000, start_date=20250518T190307, end_date=20250518T190312
[2025-05-18T19:03:12.324+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 44 for task parse_channel_posts (Docker container failed: {'StatusCode': 1}; 639)
[2025-05-18T19:03:12.345+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2025-05-18T19:03:12.366+0000] {taskinstance.py:3280} INFO - 0 downstream tasks scheduled from follow-on schedule check
