[2025-05-16T21:12:55.923+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: telegram_summary_channel_1137503644.parse_channel_posts manual__2025-05-16T21:12:54.098797+00:00 [queued]>
[2025-05-16T21:12:55.944+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: telegram_summary_channel_1137503644.parse_channel_posts manual__2025-05-16T21:12:54.098797+00:00 [queued]>
[2025-05-16T21:12:55.945+0000] {taskinstance.py:2170} INFO - Starting attempt 1 of 2
[2025-05-16T21:12:55.975+0000] {taskinstance.py:2191} INFO - Executing <Task(DockerOperator): parse_channel_posts> on 2025-05-16 21:12:54.098797+00:00
[2025-05-16T21:12:55.991+0000] {standard_task_runner.py:60} INFO - Started process 225 to run task
[2025-05-16T21:12:56.001+0000] {standard_task_runner.py:87} INFO - Running: ['airflow', 'tasks', 'run', 'telegram_summary_channel_1137503644', 'parse_channel_posts', 'manual__2025-05-16T21:12:54.098797+00:00', '--job-id', '15', '--raw', '--subdir', 'DAGS_FOLDER/dag_generator.py', '--cfg-path', '/tmp/tmplbk862va']
[2025-05-16T21:12:56.007+0000] {standard_task_runner.py:88} INFO - Job 15: Subtask parse_channel_posts
[2025-05-16T21:12:56.175+0000] {task_command.py:423} INFO - Running <TaskInstance: telegram_summary_channel_1137503644.parse_channel_posts manual__2025-05-16T21:12:54.098797+00:00 [running]> on host c4f798c909ef
[2025-05-16T21:12:56.410+0000] {taskinstance.py:2480} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='airflow' AIRFLOW_CTX_DAG_ID='telegram_summary_channel_1137503644' AIRFLOW_CTX_TASK_ID='parse_channel_posts' AIRFLOW_CTX_EXECUTION_DATE='2025-05-16T21:12:54.098797+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-05-16T21:12:54.098797+00:00'
[2025-05-16T21:12:56.551+0000] {docker.py:359} INFO - Starting docker container from image telegram_parser_task:latest
[2025-05-16T21:12:57.207+0000] {docker.py:429} INFO - [2025-05-16 21:12:57] [INFO] [Parser] - –ó–∞–ø—É—Å–∫ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –ø–∞—Ä—Å–µ—Ä–∞ (–ª–æ–∫–∞–ª—å–Ω—ã–π –∏–ª–∏ –ø—Ä—è–º–æ–π –≤—ã–∑–æ–≤)...
[2025-05-16T21:12:57.208+0000] {docker.py:429} INFO - [2025-05-16 21:12:57] [INFO] [Parser] - --- –ó–∞–ø—É—Å–∫ —Å–∫—Ä–∏–ø—Ç–∞ –ø–∞—Ä—Å–µ—Ä–∞ (Airflow Task) ---
[2025-05-16T21:12:57.208+0000] {docker.py:429} INFO - [2025-05-16 21:12:57] [INFO] [Parser] - –¶–µ–ª–µ–≤–æ–π –∫–∞–Ω–∞–ª (–∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –¥–ª—è Telethon): https://t.me/trader_chernyh
[2025-05-16T21:12:57.208+0000] {docker.py:429} INFO - [2025-05-16 21:12:57] [INFO] [Parser] - –ß–∏—Å–ª–æ–≤–æ–π ID –∫–∞–Ω–∞–ª–∞ (–∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞ DAG): 1137503644
[2025-05-16 21:12:57] [INFO] [Parser] - –¶–µ–ª–µ–≤–∞—è –¥–∞—Ç–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞: 2025-05-16
[2025-05-16 21:12:57] [INFO] [Parser] - –ü–æ–ø—ã—Ç–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î (1/5): host=postgres_results_db_service port=5432 dbname=parsing_results user=parser_user
[2025-05-16T21:12:57.222+0000] {docker.py:429} INFO - [2025-05-16 21:12:57] [INFO] [Parser] - –£—Å–ø–µ—à–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î!
[2025-05-16 21:12:57] [INFO] [Parser] - –ü—Ä–æ–≤–µ—Ä–∫–∞/—Å–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã 'telegram_messages'...
[2025-05-16T21:12:57.236+0000] {docker.py:429} INFO - [2025-05-16 21:12:57] [INFO] [Parser] - –°—Ö–µ–º–∞ –ë–î 'telegram_messages' –ø—Ä–æ–≤–µ—Ä–µ–Ω–∞/–æ–±–Ω–æ–≤–ª–µ–Ω–∞.
[2025-05-16 21:12:57] [INFO] [Parser] - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram –∫–ª–∏–µ–Ω—Ç–∞ —Å —Å–µ—Å—Å–∏–µ–π: /app/session/my_telegram_session
[2025-05-16T21:12:57.237+0000] {docker.py:429} INFO - [2025-05-16 21:12:57] [INFO] [Parser] - –§–∞–π–ª —Å–µ—Å—Å–∏–∏ '/app/session/my_telegram_session.session' —Å—É—â–µ—Å—Ç–≤—É–µ—Ç: True
[2025-05-16T21:12:57.242+0000] {docker.py:429} INFO - [2025-05-16 21:12:57] [INFO] [Parser] - –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Telegram...
[2025-05-16T21:12:57.243+0000] {docker.py:429} INFO - [2025-05-16 21:12:57] [INFO] [Parser] - Connecting to 149.154.167.51:443/TcpFull...
[2025-05-16T21:12:57.419+0000] {docker.py:429} INFO - [2025-05-16 21:12:57] [INFO] [Parser] - Connection to 149.154.167.51:443/TcpFull complete!
[2025-05-16T21:12:58.001+0000] {docker.py:429} INFO - [2025-05-16 21:12:57] [INFO] [Parser] - –£—Å–ø–µ—à–Ω–æ –ø–æ–¥–∫–ª—é—á–µ–Ω –∫ Telegram –∫–∞–∫ –ò–ª—å—è—Å (ID: 1257870016).
[2025-05-16 21:12:57] [INFO] [Parser] - –ù–∞—á–∞–ª–æ –ø–∞—Ä—Å–∏–Ω–≥–∞ –∫–∞–Ω–∞–ª–∞ 'https://t.me/trader_chernyh' –∑–∞ –¥–∞—Ç—É 2025-05-16
[2025-05-16 21:12:57] [INFO] [Parser] - –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∫–∞–Ω–∞–ª–µ 'https://t.me/trader_chernyh'...
[2025-05-16T21:12:58.110+0000] {docker.py:429} INFO - [2025-05-16 21:12:58] [INFO] [Parser] - –ö–∞–Ω–∞–ª –Ω–∞–π–¥–µ–Ω: '–ï–≤–≥–µ–Ω–∏–π –ß–µ—Ä–Ω—ã—Ö –∏ 401üçã' (ID: 1137503644)
[2025-05-16 21:12:58] [INFO] [Parser] - –ò—Ç–µ—Ä–∞—Ü–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π —Å offset_date=2025-05-17T00:00:00+00:00 (–ø–æ–∏—Å–∫ —Å–æ–æ–±—â–µ–Ω–∏–π –î–û —ç—Ç–æ–π –¥–∞—Ç—ã)...
[2025-05-16T21:12:58.604+0000] {docker.py:429} INFO - [2025-05-16 21:12:58] [INFO] [Parser] - –î–æ—Å—Ç–∏–≥–Ω—É—Ç–æ –Ω–∞—á–∞–ª–æ –¥–Ω—è 2025-05-16 (—Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç 2025-05-15 19:15:24+00:00). –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∏—Ç–µ—Ä–∞—Ü–∏–∏.
[2025-05-16 21:12:58] [INFO] [Parser] - –ü–∞—Ä—Å–∏–Ω–≥ –∑–∞ 2025-05-16 –∑–∞–≤–µ—Ä—à–µ–Ω. –ü–æ–ª—É—á–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–π: 3
[2025-05-16 21:12:58] [INFO] [Parser] - –°–ø–∏—Å–æ–∫ —Å–æ–æ–±—â–µ–Ω–∏–π —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç (–æ—Ç —Å—Ç–∞—Ä—ã—Ö –∫ –Ω–æ–≤—ã–º).
[2025-05-16 21:12:58] [INFO] [Parser] - –£—Å–ø–µ—à–Ω–æ –ø–æ–ª—É—á–µ–Ω–æ 3 —Å–æ–æ–±—â–µ–Ω–∏–π –∏–∑ Telegram.
[2025-05-16 21:12:58] [INFO] [Parser] - –ù–∞—á–∞–ª–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è 3 —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –ë–î...
[2025-05-16 21:12:58] [ERROR] [Parser] - –ù–µ–æ–∂–∏–¥–∞–Ω–Ω–∞—è –æ—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–µ/–≤—Å—Ç–∞–≤–∫–µ —Å–æ–æ–±—â–µ–Ω–∏—è ID=9660: name 'Json' is not defined
Traceback (most recent call last):
  File "/app/telegram_parser.py", line 374, in save_messages_to_db
    db_insert_data['raw_data_json'] = Json(db_insert_data.get('raw_data', {}))
NameError: name 'Json' is not defined
[2025-05-16 21:12:58] [ERROR] [Parser] - –ù–µ–æ–∂–∏–¥–∞–Ω–Ω–∞—è –æ—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–µ/–≤—Å—Ç–∞–≤–∫–µ —Å–æ–æ–±—â–µ–Ω–∏—è ID=9662: name 'Json' is not defined
Traceback (most recent call last):
  File "/app/telegram_parser.py", line 374, in save_messages_to_db
    db_insert_data['raw_data_json'] = Json(db_insert_data.get('raw_data', {}))
NameError: name 'Json' is not defined
[2025-05-16 21:12:58] [ERROR] [Parser] - –ù–µ–æ–∂–∏–¥–∞–Ω–Ω–∞—è –æ—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–µ/–≤—Å—Ç–∞–≤–∫–µ —Å–æ–æ–±—â–µ–Ω–∏—è ID=9663: name 'Json' is not defined
Traceback (most recent call last):
  File "/app/telegram_parser.py", line 374, in save_messages_to_db
    db_insert_data['raw_data_json'] = Json(db_insert_data.get('raw_data', {}))
NameError: name 'Json' is not defined
[2025-05-16 21:12:58] [INFO] [Parser] - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î –∑–∞–≤–µ—Ä—à–µ–Ω–æ. –ù–æ–≤—ã—Ö –∑–∞–ø–∏—Å–µ–π: 0, –ø—Ä–æ–ø—É—â–µ–Ω–æ (–æ—à–∏–±–∫–∏/–¥—É–±–ª–∏–∫–∞—Ç—ã): 3.
[2025-05-16 21:12:58] [INFO] [Parser] - –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ –ë–î: 0 –Ω–æ–≤—ã—Ö, 3 –ø—Ä–æ–ø—É—â–µ–Ω–æ.
[2025-05-16 21:12:58] [INFO] [Parser] - –ó–∞–ø–∏—Å—å –¥–∞–Ω–Ω—ã—Ö XCom –≤ —Ñ–∞–π–ª: /airflow/xcom/return.json
[2025-05-16 21:12:58] [INFO] [Parser] - –°–æ–∑–¥–∞–Ω–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –¥–ª—è XCom: /airflow/xcom
[2025-05-16 21:12:58] [INFO] [Parser] - –î–∞–Ω–Ω—ã–µ XCom —É—Å–ø–µ—à–Ω–æ –∑–∞–ø–∏—Å–∞–Ω—ã: {'channel_id': 1137503644, 'target_date_str': '2025-05-16', 'parsed_count': 3, 'saved_count': 0, 'status': 'success'}
[2025-05-16 21:12:58] [INFO] [Parser] - –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –æ—Ç Telegram...
[2025-05-16 21:12:58] [INFO] [Parser] - Disconnecting from 149.154.167.51:443/TcpFull...
[2025-05-16T21:12:58.606+0000] {docker.py:429} INFO - [2025-05-16 21:12:58] [INFO] [Parser] - Disconnection from 149.154.167.51:443/TcpFull complete!
[2025-05-16T21:12:58.623+0000] {docker.py:429} INFO - [2025-05-16 21:12:58] [INFO] [Parser] - –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å Telegram –∑–∞–∫—Ä—ã—Ç–æ.
[2025-05-16 21:12:58] [INFO] [Parser] - –ó–∞–∫—Ä—ã—Ç–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å –ë–î...
[2025-05-16T21:12:58.627+0000] {docker.py:429} INFO - [2025-05-16 21:12:58] [INFO] [Parser] - –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å –ë–î –∑–∞–∫—Ä—ã—Ç–æ.
[2025-05-16 21:12:58] [INFO] [Parser] - --- –°–∫—Ä–∏–ø—Ç –ø–∞—Ä—Å–µ—Ä–∞ –∑–∞–≤–µ—Ä—à–µ–Ω —Å –∫–æ–¥–æ–º –≤—ã—Ö–æ–¥–∞: 0 ---
[2025-05-16 21:12:58] [INFO] [Parser] - –ü–µ—Ä–µ—Ö–≤–∞—á–µ–Ω SystemExit —Å –∫–æ–¥–æ–º 0. –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ.
[2025-05-16 21:12:58] [INFO] [Parser] - –°–∫—Ä–∏–ø—Ç –ø–∞—Ä—Å–µ—Ä–∞ –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–æ –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è —Å –∫–æ–¥–æ–º 0 (–∏–∑ __main__ –±–ª–æ–∫–∞).
[2025-05-16T21:12:59.133+0000] {taskinstance.py:1138} INFO - Marking task as SUCCESS. dag_id=telegram_summary_channel_1137503644, task_id=parse_channel_posts, execution_date=20250516T211254, start_date=20250516T211255, end_date=20250516T211259
[2025-05-16T21:12:59.169+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 0
[2025-05-16T21:12:59.194+0000] {taskinstance.py:3280} INFO - 1 downstream tasks scheduled from follow-on schedule check
