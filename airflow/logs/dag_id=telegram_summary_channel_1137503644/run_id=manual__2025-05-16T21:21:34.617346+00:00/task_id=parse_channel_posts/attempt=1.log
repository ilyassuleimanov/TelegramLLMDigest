[2025-05-16T21:21:35.507+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: telegram_summary_channel_1137503644.parse_channel_posts manual__2025-05-16T21:21:34.617346+00:00 [queued]>
[2025-05-16T21:21:35.515+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: telegram_summary_channel_1137503644.parse_channel_posts manual__2025-05-16T21:21:34.617346+00:00 [queued]>
[2025-05-16T21:21:35.515+0000] {taskinstance.py:2170} INFO - Starting attempt 1 of 2
[2025-05-16T21:21:35.526+0000] {taskinstance.py:2191} INFO - Executing <Task(DockerOperator): parse_channel_posts> on 2025-05-16 21:21:34.617346+00:00
[2025-05-16T21:21:35.532+0000] {standard_task_runner.py:60} INFO - Started process 217 to run task
[2025-05-16T21:21:35.536+0000] {standard_task_runner.py:87} INFO - Running: ['airflow', 'tasks', 'run', 'telegram_summary_channel_1137503644', 'parse_channel_posts', 'manual__2025-05-16T21:21:34.617346+00:00', '--job-id', '19', '--raw', '--subdir', 'DAGS_FOLDER/dag_generator.py', '--cfg-path', '/tmp/tmpwhb6jg41']
[2025-05-16T21:21:35.539+0000] {standard_task_runner.py:88} INFO - Job 19: Subtask parse_channel_posts
[2025-05-16T21:21:35.609+0000] {task_command.py:423} INFO - Running <TaskInstance: telegram_summary_channel_1137503644.parse_channel_posts manual__2025-05-16T21:21:34.617346+00:00 [running]> on host 54e581570618
[2025-05-16T21:21:35.723+0000] {taskinstance.py:2480} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='airflow' AIRFLOW_CTX_DAG_ID='telegram_summary_channel_1137503644' AIRFLOW_CTX_TASK_ID='parse_channel_posts' AIRFLOW_CTX_EXECUTION_DATE='2025-05-16T21:21:34.617346+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-05-16T21:21:34.617346+00:00'
[2025-05-16T21:21:35.844+0000] {docker.py:359} INFO - Starting docker container from image telegram_parser_task:latest
[2025-05-16T21:21:36.523+0000] {docker.py:429} INFO - [2025-05-16 21:21:36] [INFO] [Parser] - –ó–∞–ø—É—Å–∫ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –ø–∞—Ä—Å–µ—Ä–∞ (–ª–æ–∫–∞–ª—å–Ω—ã–π –∏–ª–∏ –ø—Ä—è–º–æ–π –≤—ã–∑–æ–≤)...
[2025-05-16T21:21:36.524+0000] {docker.py:429} INFO - [2025-05-16 21:21:36] [INFO] [Parser] - --- –ó–∞–ø—É—Å–∫ —Å–∫—Ä–∏–ø—Ç–∞ –ø–∞—Ä—Å–µ—Ä–∞ (Airflow Task) ---
[2025-05-16 21:21:36] [INFO] [Parser] - –¶–µ–ª–µ–≤–æ–π –∫–∞–Ω–∞–ª (–∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –¥–ª—è Telethon): https://t.me/trader_chernyh
[2025-05-16 21:21:36] [INFO] [Parser] - –ß–∏—Å–ª–æ–≤–æ–π ID –∫–∞–Ω–∞–ª–∞ (–∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞ DAG): 1137503644
[2025-05-16 21:21:36] [INFO] [Parser] - –¶–µ–ª–µ–≤–∞—è –¥–∞—Ç–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞: 2025-05-16
[2025-05-16 21:21:36] [INFO] [Parser] - –ü–æ–ø—ã—Ç–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î (1/5): host=postgres_results_db_service port=5432 dbname=parsing_results user=parser_user
[2025-05-16T21:21:36.534+0000] {docker.py:429} INFO - [2025-05-16 21:21:36] [INFO] [Parser] - –£—Å–ø–µ—à–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î!
[2025-05-16 21:21:36] [INFO] [Parser] - –ü—Ä–æ–≤–µ—Ä–∫–∞/—Å–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã 'telegram_messages'...
[2025-05-16T21:21:36.545+0000] {docker.py:429} INFO - [2025-05-16 21:21:36] [INFO] [Parser] - –°—Ö–µ–º–∞ –ë–î 'telegram_messages' –ø—Ä–æ–≤–µ—Ä–µ–Ω–∞/–æ–±–Ω–æ–≤–ª–µ–Ω–∞.
[2025-05-16 21:21:36] [INFO] [Parser] - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram –∫–ª–∏–µ–Ω—Ç–∞ —Å —Å–µ—Å—Å–∏–µ–π: /app/session/my_telegram_session
[2025-05-16 21:21:36] [INFO] [Parser] - –§–∞–π–ª —Å–µ—Å—Å–∏–∏ '/app/session/my_telegram_session.session' —Å—É—â–µ—Å—Ç–≤—É–µ—Ç: True
[2025-05-16T21:21:36.548+0000] {docker.py:429} INFO - [2025-05-16 21:21:36] [INFO] [Parser] - –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Telegram...
[2025-05-16T21:21:36.549+0000] {docker.py:429} INFO - [2025-05-16 21:21:36] [INFO] [Parser] - Connecting to 149.154.167.51:443/TcpFull...
[2025-05-16T21:21:36.715+0000] {docker.py:429} INFO - [2025-05-16 21:21:36] [INFO] [Parser] - Connection to 149.154.167.51:443/TcpFull complete!
[2025-05-16T21:21:37.299+0000] {docker.py:429} INFO - [2025-05-16 21:21:37] [INFO] [Parser] - –£—Å–ø–µ—à–Ω–æ –ø–æ–¥–∫–ª—é—á–µ–Ω –∫ Telegram –∫–∞–∫ –ò–ª—å—è—Å (ID: 1257870016).
[2025-05-16 21:21:37] [INFO] [Parser] - –ù–∞—á–∞–ª–æ –ø–∞—Ä—Å–∏–Ω–≥–∞ –∫–∞–Ω–∞–ª–∞ 'https://t.me/trader_chernyh' –∑–∞ –¥–∞—Ç—É 2025-05-16
[2025-05-16T21:21:37.300+0000] {docker.py:429} INFO - [2025-05-16 21:21:37] [INFO] [Parser] - –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∫–∞–Ω–∞–ª–µ 'https://t.me/trader_chernyh'...
[2025-05-16T21:21:37.414+0000] {docker.py:429} INFO - [2025-05-16 21:21:37] [INFO] [Parser] - –ö–∞–Ω–∞–ª –Ω–∞–π–¥–µ–Ω: '–ï–≤–≥–µ–Ω–∏–π –ß–µ—Ä–Ω—ã—Ö –∏ 401üçã' (ID: 1137503644)
[2025-05-16 21:21:37] [INFO] [Parser] - –ò—Ç–µ—Ä–∞—Ü–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π —Å offset_date=2025-05-17T00:00:00+00:00 (–ø–æ–∏—Å–∫ —Å–æ–æ–±—â–µ–Ω–∏–π –î–û —ç—Ç–æ–π –¥–∞—Ç—ã)...
[2025-05-16T21:21:38.009+0000] {docker.py:429} INFO - [2025-05-16 21:21:38] [INFO] [Parser] - –î–æ—Å—Ç–∏–≥–Ω—É—Ç–æ –Ω–∞—á–∞–ª–æ –¥–Ω—è 2025-05-16 (—Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç 2025-05-15 19:15:24+00:00). –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∏—Ç–µ—Ä–∞—Ü–∏–∏.
[2025-05-16 21:21:38] [INFO] [Parser] - –ü–∞—Ä—Å–∏–Ω–≥ –∑–∞ 2025-05-16 –∑–∞–≤–µ—Ä—à–µ–Ω. –ü–æ–ª—É—á–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–π: 3
[2025-05-16 21:21:38] [INFO] [Parser] - –°–ø–∏—Å–æ–∫ —Å–æ–æ–±—â–µ–Ω–∏–π —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç (–æ—Ç —Å—Ç–∞—Ä—ã—Ö –∫ –Ω–æ–≤—ã–º).
[2025-05-16 21:21:38] [INFO] [Parser] - –£—Å–ø–µ—à–Ω–æ –ø–æ–ª—É—á–µ–Ω–æ 3 —Å–æ–æ–±—â–µ–Ω–∏–π –∏–∑ Telegram.
[2025-05-16 21:21:38] [INFO] [Parser] - –ù–∞—á–∞–ª–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è 3 —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –ë–î...
[2025-05-16T21:21:38.012+0000] {docker.py:429} INFO - [2025-05-16 21:21:38] [ERROR] [Parser] - –ù–µ–æ–∂–∏–¥–∞–Ω–Ω–∞—è –æ—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–µ/–≤—Å—Ç–∞–≤–∫–µ —Å–æ–æ–±—â–µ–Ω–∏—è ID=9660: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/app/telegram_parser.py", line 376, in save_messages_to_db
    cur.execute(insert_query, db_insert_data)
  File "/usr/local/lib/python3.9/site-packages/psycopg2/_json.py", line 78, in getquoted
    s = self.dumps(self.adapted)
  File "/usr/local/lib/python3.9/site-packages/psycopg2/_json.py", line 72, in dumps
    return self._dumps(obj)
  File "/usr/local/lib/python3.9/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
  File "/usr/local/lib/python3.9/json/encoder.py", line 199, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/usr/local/lib/python3.9/json/encoder.py", line 257, in iterencode
    return _iterencode(o, 0)
  File "/usr/local/lib/python3.9/json/encoder.py", line 179, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type datetime is not JSON serializable
[2025-05-16 21:21:38] [ERROR] [Parser] - –ù–µ–æ–∂–∏–¥–∞–Ω–Ω–∞—è –æ—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–µ/–≤—Å—Ç–∞–≤–∫–µ —Å–æ–æ–±—â–µ–Ω–∏—è ID=9662: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/app/telegram_parser.py", line 376, in save_messages_to_db
    cur.execute(insert_query, db_insert_data)
  File "/usr/local/lib/python3.9/site-packages/psycopg2/_json.py", line 78, in getquoted
    s = self.dumps(self.adapted)
  File "/usr/local/lib/python3.9/site-packages/psycopg2/_json.py", line 72, in dumps
    return self._dumps(obj)
  File "/usr/local/lib/python3.9/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
  File "/usr/local/lib/python3.9/json/encoder.py", line 199, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/usr/local/lib/python3.9/json/encoder.py", line 257, in iterencode
    return _iterencode(o, 0)
  File "/usr/local/lib/python3.9/json/encoder.py", line 179, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type datetime is not JSON serializable
[2025-05-16T21:21:38.013+0000] {docker.py:429} INFO - [2025-05-16 21:21:38] [ERROR] [Parser] - –ù–µ–æ–∂–∏–¥–∞–Ω–Ω–∞—è –æ—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–µ/–≤—Å—Ç–∞–≤–∫–µ —Å–æ–æ–±—â–µ–Ω–∏—è ID=9663: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/app/telegram_parser.py", line 376, in save_messages_to_db
    cur.execute(insert_query, db_insert_data)
  File "/usr/local/lib/python3.9/site-packages/psycopg2/_json.py", line 78, in getquoted
    s = self.dumps(self.adapted)
  File "/usr/local/lib/python3.9/site-packages/psycopg2/_json.py", line 72, in dumps
    return self._dumps(obj)
  File "/usr/local/lib/python3.9/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
  File "/usr/local/lib/python3.9/json/encoder.py", line 199, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/usr/local/lib/python3.9/json/encoder.py", line 257, in iterencode
    return _iterencode(o, 0)
  File "/usr/local/lib/python3.9/json/encoder.py", line 179, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type datetime is not JSON serializable
[2025-05-16 21:21:38] [INFO] [Parser] - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î –∑–∞–≤–µ—Ä—à–µ–Ω–æ. –ù–æ–≤—ã—Ö –∑–∞–ø–∏—Å–µ–π: 0, –ø—Ä–æ–ø—É—â–µ–Ω–æ (–æ—à–∏–±–∫–∏/–¥—É–±–ª–∏–∫–∞—Ç—ã): 3.
[2025-05-16 21:21:38] [INFO] [Parser] - –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ –ë–î: 0 –Ω–æ–≤—ã—Ö, 3 –ø—Ä–æ–ø—É—â–µ–Ω–æ.
[2025-05-16 21:21:38] [INFO] [Parser] - –ó–∞–ø–∏—Å—å –¥–∞–Ω–Ω—ã—Ö XCom –≤ —Ñ–∞–π–ª: /airflow/xcom/return.json
[2025-05-16T21:21:38.013+0000] {docker.py:429} INFO - [2025-05-16 21:21:38] [INFO] [Parser] - –°–æ–∑–¥–∞–Ω–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –¥–ª—è XCom: /airflow/xcom
[2025-05-16T21:21:38.013+0000] {docker.py:429} INFO - [2025-05-16 21:21:38] [INFO] [Parser] - –î–∞–Ω–Ω—ã–µ XCom —É—Å–ø–µ—à–Ω–æ –∑–∞–ø–∏—Å–∞–Ω—ã: {'channel_id': 1137503644, 'target_date_str': '2025-05-16', 'parsed_count': 3, 'saved_count': 0, 'status': 'success'}
[2025-05-16T21:21:38.014+0000] {docker.py:429} INFO - [2025-05-16 21:21:38] [INFO] [Parser] - –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –æ—Ç Telegram...
[2025-05-16T21:21:38.014+0000] {docker.py:429} INFO - [2025-05-16 21:21:38] [INFO] [Parser] - Disconnecting from 149.154.167.51:443/TcpFull...
[2025-05-16T21:21:38.015+0000] {docker.py:429} INFO - [2025-05-16 21:21:38] [INFO] [Parser] - Disconnection from 149.154.167.51:443/TcpFull complete!
[2025-05-16T21:21:38.027+0000] {docker.py:429} INFO - [2025-05-16 21:21:38] [INFO] [Parser] - –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å Telegram –∑–∞–∫—Ä—ã—Ç–æ.
[2025-05-16 21:21:38] [INFO] [Parser] - –ó–∞–∫—Ä—ã—Ç–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å –ë–î...
[2025-05-16T21:21:38.028+0000] {docker.py:429} INFO - [2025-05-16 21:21:38] [INFO] [Parser] - –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å –ë–î –∑–∞–∫—Ä—ã—Ç–æ.
[2025-05-16 21:21:38] [INFO] [Parser] - --- –°–∫—Ä–∏–ø—Ç –ø–∞—Ä—Å–µ—Ä–∞ –∑–∞–≤–µ—Ä—à–µ–Ω —Å –∫–æ–¥–æ–º –≤—ã—Ö–æ–¥–∞: 0 ---
[2025-05-16 21:21:38] [INFO] [Parser] - –ü–µ—Ä–µ—Ö–≤–∞—á–µ–Ω SystemExit —Å –∫–æ–¥–æ–º 0. –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ.
[2025-05-16 21:21:38] [INFO] [Parser] - –°–∫—Ä–∏–ø—Ç –ø–∞—Ä—Å–µ—Ä–∞ –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–æ –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è —Å –∫–æ–¥–æ–º 0 (–∏–∑ __main__ –±–ª–æ–∫–∞).
[2025-05-16T21:21:38.547+0000] {taskinstance.py:1138} INFO - Marking task as SUCCESS. dag_id=telegram_summary_channel_1137503644, task_id=parse_channel_posts, execution_date=20250516T212134, start_date=20250516T212135, end_date=20250516T212138
[2025-05-16T21:21:38.573+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 0
[2025-05-16T21:21:38.603+0000] {taskinstance.py:3280} INFO - 1 downstream tasks scheduled from follow-on schedule check
