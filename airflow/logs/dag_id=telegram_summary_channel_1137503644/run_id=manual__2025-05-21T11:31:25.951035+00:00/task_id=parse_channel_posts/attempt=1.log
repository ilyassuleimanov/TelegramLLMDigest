[2025-05-21T11:31:26.533+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: telegram_summary_channel_1137503644.parse_channel_posts manual__2025-05-21T11:31:25.951035+00:00 [queued]>
[2025-05-21T11:31:26.537+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: telegram_summary_channel_1137503644.parse_channel_posts manual__2025-05-21T11:31:25.951035+00:00 [queued]>
[2025-05-21T11:31:26.537+0000] {taskinstance.py:2170} INFO - Starting attempt 1 of 2
[2025-05-21T11:31:26.545+0000] {taskinstance.py:2191} INFO - Executing <Task(DockerOperator): parse_channel_posts> on 2025-05-21 11:31:25.951035+00:00
[2025-05-21T11:31:26.550+0000] {standard_task_runner.py:60} INFO - Started process 231 to run task
[2025-05-21T11:31:26.553+0000] {standard_task_runner.py:87} INFO - Running: ['airflow', 'tasks', 'run', 'telegram_summary_channel_1137503644', 'parse_channel_posts', 'manual__2025-05-21T11:31:25.951035+00:00', '--job-id', '238', '--raw', '--subdir', 'DAGS_FOLDER/dag_generator.py', '--cfg-path', '/tmp/tmpew7s4q2t']
[2025-05-21T11:31:26.554+0000] {standard_task_runner.py:88} INFO - Job 238: Subtask parse_channel_posts
[2025-05-21T11:31:26.590+0000] {task_command.py:423} INFO - Running <TaskInstance: telegram_summary_channel_1137503644.parse_channel_posts manual__2025-05-21T11:31:25.951035+00:00 [running]> on host ae09eee6c3ae
[2025-05-21T11:31:26.664+0000] {taskinstance.py:2480} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='airflow' AIRFLOW_CTX_DAG_ID='telegram_summary_channel_1137503644' AIRFLOW_CTX_TASK_ID='parse_channel_posts' AIRFLOW_CTX_EXECUTION_DATE='2025-05-21T11:31:25.951035+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-05-21T11:31:25.951035+00:00'
[2025-05-21T11:31:26.719+0000] {docker.py:359} INFO - Starting docker container from image telegram_parser_task:latest
[2025-05-21T11:31:27.059+0000] {docker.py:429} INFO - [2025-05-21 11:31:27] [INFO] [Parser] - –ó–∞–ø—É—Å–∫ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –ø–∞—Ä—Å–µ—Ä–∞ (–ª–æ–∫–∞–ª—å–Ω—ã–π –∏–ª–∏ –ø—Ä—è–º–æ–π –≤—ã–∑–æ–≤)...
[2025-05-21T11:31:27.059+0000] {docker.py:429} INFO - [2025-05-21 11:31:27] [INFO] [Parser] - --- –ó–∞–ø—É—Å–∫ —Å–∫—Ä–∏–ø—Ç–∞ –ø–∞—Ä—Å–µ—Ä–∞ (Airflow Task) ---
[2025-05-21 11:31:27] [INFO] [Parser] - –ü–æ–ø—ã—Ç–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î (1/5): host=postgres_results_db_service port=5432 dbname=parsing_results user=parser_user
[2025-05-21T11:31:27.064+0000] {docker.py:429} INFO - [2025-05-21 11:31:27] [INFO] [Parser] - –£—Å–ø–µ—à–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î!
[2025-05-21 11:31:27] [INFO] [Parser] - –ü—Ä–æ–≤–µ—Ä–∫–∞/—Å–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã 'telegram_messages'...
[2025-05-21T11:31:27.067+0000] {docker.py:429} INFO - [2025-05-21 11:31:27] [INFO] [Parser] - –°—Ö–µ–º–∞ –ë–î 'telegram_messages' –ø—Ä–æ–≤–µ—Ä–µ–Ω–∞/–æ–±–Ω–æ–≤–ª–µ–Ω–∞.
[2025-05-21 11:31:27] [INFO] [Parser] - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram –∫–ª–∏–µ–Ω—Ç–∞ —Å —Å–µ—Å—Å–∏–µ–π: /app/session/my_telegram_session
[2025-05-21 11:31:27] [INFO] [Parser] - –§–∞–π–ª —Å–µ—Å—Å–∏–∏ '/app/session/my_telegram_session.session' —Å—É—â–µ—Å—Ç–≤—É–µ—Ç: True
[2025-05-21T11:31:27.068+0000] {docker.py:429} INFO - [2025-05-21 11:31:27] [INFO] [Parser] - –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Telegram...
[2025-05-21T11:31:27.068+0000] {docker.py:429} INFO - [2025-05-21 11:31:27] [INFO] [Parser] - Connecting to 149.154.167.51:443/TcpFull...
[2025-05-21T11:31:27.119+0000] {docker.py:429} INFO - [2025-05-21 11:31:27] [INFO] [Parser] - Connection to 149.154.167.51:443/TcpFull complete!
[2025-05-21T11:31:27.576+0000] {docker.py:429} INFO - [2025-05-21 11:31:27] [INFO] [Parser] - –£—Å–ø–µ—à–Ω–æ –ø–æ–¥–∫–ª—é—á–µ–Ω –∫ Telegram –∫–∞–∫ –ò–ª—å—è—Å (ID: 1257870016).
[2025-05-21 11:31:27] [INFO] [Parser] - –ù–∞—á–∞–ª–æ –ø–∞—Ä—Å–∏–Ω–≥–∞ –∫–∞–Ω–∞–ª–∞ 'https://t.me/trader_chernyh' –∑–∞ –¥–∞—Ç—É 2025-05-21
[2025-05-21 11:31:27] [INFO] [Parser] - –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∫–∞–Ω–∞–ª–µ 'https://t.me/trader_chernyh'...
[2025-05-21T11:31:27.651+0000] {docker.py:429} INFO - [2025-05-21 11:31:27] [INFO] [Parser] - –ö–∞–Ω–∞–ª –Ω–∞–π–¥–µ–Ω: '–ï–≤–≥–µ–Ω–∏–π –ß–µ—Ä–Ω—ã—Ö –∏ 401üçã' (ID: 1137503644)
[2025-05-21 11:31:27] [INFO] [Parser] - –ò—Ç–µ—Ä–∞—Ü–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π —Å offset_date=2025-05-22T00:00:00+00:00...
[2025-05-21T11:31:28.018+0000] {docker.py:429} INFO - [2025-05-21 11:31:28] [INFO] [Parser] - –î–æ—Å—Ç–∏–≥–Ω—É—Ç–æ –Ω–∞—á–∞–ª–æ –¥–Ω—è 2025-05-21. –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∏—Ç–µ—Ä–∞—Ü–∏–∏.
[2025-05-21 11:31:28] [INFO] [Parser] - –ü–∞—Ä—Å–∏–Ω–≥ –∑–∞–≤–µ—Ä—à–µ–Ω. –ü–æ–ª—É—á–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–π: 1
[2025-05-21 11:31:28] [INFO] [Parser] - –°–ø–∏—Å–æ–∫ —Å–æ–æ–±—â–µ–Ω–∏–π —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç.
[2025-05-21 11:31:28] [INFO] [Parser] - –£—Å–ø–µ—à–Ω–æ –ø–æ–ª—É—á–µ–Ω–æ 1 —Å–æ–æ–±—â–µ–Ω–∏–π –∏–∑ Telegram.
[2025-05-21 11:31:28] [INFO] [Parser] - –ù–∞—á–∞–ª–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è 1 —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –ë–î...
[2025-05-21T11:31:28.019+0000] {docker.py:429} INFO - [2025-05-21 11:31:28] [INFO] [Parser] - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î –∑–∞–≤–µ—Ä—à–µ–Ω–æ. –ù–æ–≤—ã—Ö –∑–∞–ø–∏—Å–µ–π: 0, –ø—Ä–æ–ø—É—â–µ–Ω–æ (–æ—à–∏–±–∫–∏/–¥—É–±–ª–∏–∫–∞—Ç—ã): 1.
[2025-05-21 11:31:28] [INFO] [Parser] - –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ –ë–î: 0 –Ω–æ–≤—ã—Ö, 1 –ø—Ä–æ–ø—É—â–µ–Ω–æ (–¥—É–±–ª–∏–∫–∞—Ç—ã/–æ—à–∏–±–∫–∏).
[2025-05-21 11:31:28] [INFO] [Parser] - –í—Å–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É—é—Ç –≤ –ë–î (–∏–ª–∏ –±—ã–ª–∏ –ø—Ä–æ–ø—É—â–µ–Ω—ã –±–µ–∑ –æ—à–∏–±–æ–∫ –≤—Å—Ç–∞–≤–∫–∏).
[2025-05-21 11:31:28] [INFO] [Parser] - –ó–∞–ø–∏—Å—å –¥–∞–Ω–Ω—ã—Ö XCom –≤ —Ñ–∞–π–ª: /airflow/xcom/return.json
[2025-05-21T11:31:28.019+0000] {docker.py:429} INFO - [2025-05-21 11:31:28] [INFO] [Parser] - –°–æ–∑–¥–∞–Ω–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –¥–ª—è XCom: /airflow/xcom
[2025-05-21T11:31:28.019+0000] {docker.py:429} INFO - [2025-05-21 11:31:28] [INFO] [Parser] - –î–∞–Ω–Ω—ã–µ XCom —É—Å–ø–µ—à–Ω–æ –∑–∞–ø–∏—Å–∞–Ω—ã: {'channel_id': 1137503644, 'target_date_str': '2025-05-21', 'parsed_count': 1, 'saved_count': 0, 'skipped_because_duplicate_or_no_error': 1, 'status': 'success_duplicates_found', 'error_type': None, 'error_message': None}
[2025-05-21T11:31:28.020+0000] {docker.py:429} INFO - [2025-05-21 11:31:28] [INFO] [Parser] - –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –æ—Ç Telegram...
[2025-05-21T11:31:28.020+0000] {docker.py:429} INFO - [2025-05-21 11:31:28] [INFO] [Parser] - Disconnecting from 149.154.167.51:443/TcpFull...
[2025-05-21T11:31:28.021+0000] {docker.py:429} INFO - [2025-05-21 11:31:28] [INFO] [Parser] - Disconnection from 149.154.167.51:443/TcpFull complete!
[2025-05-21T11:31:28.024+0000] {docker.py:429} INFO - [2025-05-21 11:31:28] [INFO] [Parser] - –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å Telegram –∑–∞–∫—Ä—ã—Ç–æ.
[2025-05-21 11:31:28] [INFO] [Parser] - –ó–∞–∫—Ä—ã—Ç–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å –ë–î...
[2025-05-21T11:31:28.025+0000] {docker.py:429} INFO - [2025-05-21 11:31:28] [INFO] [Parser] - –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å –ë–î –∑–∞–∫—Ä—ã—Ç–æ.
[2025-05-21 11:31:28] [INFO] [Parser] - --- –°–∫—Ä–∏–ø—Ç –ø–∞—Ä—Å–µ—Ä–∞ –∑–∞–≤–µ—Ä—à–µ–Ω —Å –∫–æ–¥–æ–º –≤—ã—Ö–æ–¥–∞: 0 (XCom –∑–∞–ø–∏—Å–∞–Ω: True) ---
[2025-05-21 11:31:28] [INFO] [Parser] - –ü–µ—Ä–µ—Ö–≤–∞—á–µ–Ω SystemExit —Å –∫–æ–¥–æ–º 0. –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ (–∏–∑ __main__).
[2025-05-21T11:31:28.065+0000] {docker.py:429} INFO - Python script exited with code 0
Found XCom file, outputting its content for XCom push:
[2025-05-21T11:31:28.065+0000] {docker.py:429} INFO - {
  "channel_id": 1137503644,
  "target_date_str": "2025-05-21",
  "parsed_count": 1,
  "saved_count": 0,
  "skipped_because_duplicate_or_no_error": 1,
  "status": "success_duplicates_found",
  "error_type": null,
  "error_message": null
}
[2025-05-21T11:31:28.267+0000] {taskinstance.py:1138} INFO - Marking task as SUCCESS. dag_id=telegram_summary_channel_1137503644, task_id=parse_channel_posts, execution_date=20250521T113125, start_date=20250521T113126, end_date=20250521T113128
[2025-05-21T11:31:28.294+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 0
[2025-05-21T11:31:28.314+0000] {taskinstance.py:3280} INFO - 1 downstream tasks scheduled from follow-on schedule check
